HomeScreen As screen:
    Fill: =RGBA(244, 247, 249, 1)
    OnVisible: |-
        =If(CountRows( Filter(
                    'Travel Requests',
                    'Requested By'.'Primary Email' = User().Email && 'Travel Request Status'='Travel Request Status (Travel Requests)'.'Approved Pending Booking'))>0,UpdateContext({varShowApprovedExistsDialog:true})
                )

    Container1 As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        ZIndex: =1

        Container2 As groupContainer.manualLayoutContainer:
            FillPortions: =0
            Height: =230
            LayoutMinHeight: =200
            LayoutMinWidth: =250
            Width: =App.Width
            ZIndex: =2

            rectMidHeader As rectangle:
                BorderColor: =RGBA(245, 245, 245, 1)
                BorderThickness: =2
                Fill: =RGBA(255, 255, 255, 1)
                Width: =Parent.Width
                Y: =125
                ZIndex: =1

            rectTopHeader As rectangle:
                Fill: =RGBA(255, 255, 255, 1)
                Width: =Parent.Width
                Y: =4
                ZIndex: =2

            lblHeader As label:
                Color: =RGBA(128, 128, 128, 1)
                Height: =70
                Size: =21
                Text: ="Travel Request App"
                Width: =Parent.Width-Self.X
                X: =20
                Y: =19
                ZIndex: =3

            btnSelf As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(127, 178, 57, 1)
                Fill: =RGBA(237, 237, 237, 1)
                Height: =46
                HoverColor: =RGBA(237, 237, 237, 1)
                HoverFill: =RGBA(127, 178, 57, 1)
                RadiusBottomLeft: =20
                RadiusBottomRight: =20
                RadiusTopLeft: =20
                RadiusTopRight: =20
                Size: =12
                Text: =locRole
                Width: =212
                X: =23
                Y: =154
                ZIndex: =4

            Image2 As image:
                Height: =57
                Image: |-
                    ="data:image/svg+xml;utf8, %3Csvg%20%20viewBox%3D%270%200%202048%202048%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%3Cpath%20d%3D%27M1280%20768v896H896V768h384zm512-512v1408h-384V256h384zM256%201792h1664v128H128V128h128v1664zM768%20512v1152H384V512h384z%27%20fill%3D%27%23000000%27%3E%3C%2Fpath%3E%3C%2Fsvg%3E"
                OnSelect: |-
                    =UpdateContext({showPowerBIDashboard:true})
                Width: =50
                X: =Parent.Width-Self.Width-30
                Y: =19
                ZIndex: =7

            grpApplyTravelRequest As group:
                Height: =5
                Width: =5
                X: =-45
                Y: =-102
                ZIndex: =7

                btnApplyTravelRequest As button:
                    BorderThickness: =1
                    Color: =RGBA(128, 128, 128, 1)
                    Fill: =RGBA(255, 255, 255, 1)
                    FontWeight: =Normal
                    Height: =58
                    OnSelect: |-
                        =Set(locShowRequestForm,true);
                        NewForm(frmTravelRequest);
                        Navigate(Screen1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =16
                    Text: ="        Apply Travel Request"
                    Width: =300
                    X: =Container2.Width-Self.Width-20
                    Y: =146
                    ZIndex: =5

                icoApplyTravelRequest As icon.Calendar:
                    Color: =RGBA(179, 179, 179, 1)
                    Height: =32
                    Icon: =Icon.AddToCalendar
                    Width: =30
                    X: =btnApplyTravelRequest.X+5
                    Y: =162
                    ZIndex: =6

        Container3 As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =150
            LayoutGap: =5
            LayoutMinHeight: =150
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =5
            Width: =Parent.Width
            X: =40
            Y: =40
            ZIndex: =3

            Container4 As groupContainer.manualLayoutContainer:
                Height: =225
                LayoutMinHeight: =112
                LayoutMinWidth: =100
                ZIndex: =1

                rectApprovedTravelRequests As rectangle:
                    BorderColor: =RGBA(245, 245, 245, 1)
                    BorderThickness: =1
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =150
                    Width: =Parent.Width
                    ZIndex: =1

                lblNoOfApproveTravelRequests As label:
                    Align: =Align.Center
                    Color: =RGBA(128, 128, 128, 1)
                    Height: =106
                    Size: =40
                    Text: |-
                        =If(
                            locRole = "Staff",
                            CountIf(
                                'Travel Requests',
                                'Requested By'.'Primary Email' = User().Email,
                                'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Approved Pending Booking'
                            ),
                            CountRows(Filter(
                                'Travel Requests',
                                ('Requested To 1'.'Primary Email' = User().Email || 'Requested To 2'.'Primary Email' = User().Email) &&
                                'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Approved Pending Booking')
                            )
                        )
                    Width: =Parent.Width
                    ZIndex: =2

                lblApprovedTravelRequests As label:
                    Align: =Center
                    Height: =80
                    Size: =14
                    Text: ="Approved Travel Requests"
                    Width: =Parent.Width
                    Y: =70
                    ZIndex: =3

            Container5 As groupContainer.manualLayoutContainer:
                Height: =132
                LayoutMinHeight: =112
                LayoutMinWidth: =100
                X: =60
                ZIndex: =2

                rectPendingTravelRequests As rectangle:
                    BorderColor: =RGBA(245, 245, 245, 1)
                    BorderThickness: =1
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =150
                    Width: =Parent.Width
                    ZIndex: =1

                lblNoOfPendingTravelRequests As label:
                    Align: =Align.Center
                    Color: =RGBA(128, 128, 128, 1)
                    Height: =106
                    Size: =40
                    Text: |-
                        =If(
                            locRole = "Staff",
                            CountIf(
                                'Travel Requests',
                                'Requested By'.'Primary Email' = User().Email,
                                'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.'Approved Pending Booking' && 'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.Rejected && 'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.Canceled 
                            ),
                            CountRows(Filter(
                                'Travel Requests',
                                ('Requested To 1'.'Primary Email' = User().Email || 'Requested To 2'.'Primary Email' = User().Email) &&
                                'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.'Approved Pending Booking' && 'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.Rejected && 'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.Canceled
                            ))
                        )
                    Width: =Parent.Width
                    ZIndex: =2

                lblPendingTravelRequests As label:
                    Align: =Center
                    Height: =80
                    Size: =14
                    Text: ="In Progress Travel Requests"
                    Width: =Parent.Width
                    Y: =70
                    ZIndex: =3

            Container6 As groupContainer.manualLayoutContainer:
                Height: =225
                LayoutMinHeight: =112
                LayoutMinWidth: =100
                ZIndex: =3

                rectRejectedTravelRequests As rectangle:
                    BorderColor: =RGBA(245, 245, 245, 1)
                    BorderThickness: =1
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =150
                    Width: =Parent.Width
                    ZIndex: =1

                lblNoOfRejectedTravelRequests As label:
                    Align: =Align.Center
                    Color: =RGBA(128, 128, 128, 1)
                    Height: =106
                    Size: =40
                    Text: |-
                        =If(
                            locRole = "Staff",
                            CountIf(
                                'Travel Requests',
                                'Requested By'.'Primary Email' = User().Email,
                                'Travel Request Status' = 'Travel Request Status (Travel Requests)'.Rejected
                            ),
                        CountRows(Filter(
                                'Travel Requests',
                                ('Requested To 1'.'Primary Email' = User().Email || 'Requested To 2'.'Primary Email' = User().Email) &&
                                'Travel Request Status' = 'Travel Request Status (Travel Requests)'.Rejected)
                            )
                        )
                    Width: =Parent.Width
                    ZIndex: =2

                lblRequestedTravelRequests As label:
                    Align: =Center
                    Height: =80
                    Size: =14
                    Text: ="Rejected Travel Requests"
                    Width: =Parent.Width
                    Y: =70
                    ZIndex: =3

        Container7 As groupContainer.verticalAutoLayoutContainer:
            Height: =225
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =10
            PaddingRight: =10
            ZIndex: =4

            lblTravelRequests As label:
                Color: =RGBA(128, 128, 128, 1)
                Height: =70
                LayoutMinHeight: =70
                LayoutMinWidth: =560
                Size: =21
                Text: =If(locRole="Staff","My Travel Requests","Travel Requests")
                Width: =560
                X: =36
                Y: =467
                ZIndex: =1

            "galTravelRequests As gallery.'BrowseLayout_Vertical_TwoTextVariant_ver4.0'":
                Fill: =RGBA(255, 255, 255, 1)
                Height: =576
                Items: |-
                    =SortByColumns(
                        If(
                            radView.Selected.Value = "Self",
                            Filter(
                                'Travel Requests',
                                'Requested By'.'Primary Email' = User().Email
                            ),
                            radView.Selected.Value = "All",
                            'Travel Requests',
                            Filter(
                                'Travel Requests',
                                ('Requested To 1'.'Primary Email' = User().Email || 'Requested To 2'.'Primary Email' = User().Email) && ('Travel Request Status' = 'Travel Request Status (Travel Requests)'.Pending || 'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Level 1 Approved' || 'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Level 2 Approved' || 'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Rework Reason'|| 'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Re-approvals Needed')
                            )
                        ),
                        "createdon",
                        Descending
                    )
                Layout: =Layout.Vertical
                LayoutMinHeight: =285
                LayoutMinWidth: =320
                TemplatePadding: =10
                TemplateSize: =245
                Width: =593
                X: =20
                Y: =537
                ZIndex: =2

                seperator As rectangle:
                    Fill: =RGBA(230, 230, 230, 1)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight - 1
                    ZIndex: =4

                Container8 As groupContainer.verticalAutoLayoutContainer:
                    Height: =245
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width-galTravelRequests.TemplatePadding*2
                    ZIndex: =13

                    Container9 As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0
                        Height: =50
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =20
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width
                        ZIndex: =1

                        lblTitle As label:
                            FillPortions: =2
                            FontWeight: =Normal
                            LayoutMinHeight: =70
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =18
                            Text: =ThisItem.'Requested By'.'Full Name'
                            VerticalAlign: =VerticalAlign.Top
                            Width: =
                            Wrap: =false
                            X: =1
                            Y: =16
                            ZIndex: =1

                        lblPriority As label:
                            Align: =Align.Right
                            Color: =RGBA(184, 0, 0, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Bold
                            LayoutMinHeight: =70
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =10
                            PaddingTop: =0
                            Size: =12
                            Text: ="! "&ThisItem.Priority
                            Visible: =ThisItem.Priority=Priority.'High Priority'
                            Width: =
                            Wrap: =false
                            X: =1
                            Y: =16
                            ZIndex: =2

                        btnStatus As button:
                            Color: |-
                                =Switch(
                                    Text(ThisItem.'Travel Request Status'),
                                    "Pending",
                                    RGBA(
                                        172,
                                        62,
                                        11,
                                        1
                                    ),
                                    "Rejected",
                                    RGBA(
                                        245,
                                        0,
                                        0,
                                        1
                                    ),
                                    "Canceled",
                                    RGBA(
                                        245,
                                        0,
                                        0,
                                        1
                                    ),
                                    "Approved",
                                    RGBA(
                                        0,
                                        245,
                                        0,
                                        .2
                                    ),
                                    "Level 1 Approved",
                                    RGBA(
                                        255,
                                        255,
                                        255,
                                        1
                                    ),
                                    "Level 2 Approved",
                                    RGBA(
                                        39,
                                        67,
                                        125,
                                        1
                                    ),
                                    RGBA(
                                        172,
                                        62,
                                        11,
                                        1
                                    )
                                )
                            DisplayMode: =DisplayMode.View
                            Fill: |-
                                =Switch(
                                    Text(ThisItem.'Travel Request Status'),
                                    "Pending",
                                    RGBA(
                                        245,
                                        175,
                                        0,
                                        .2
                                    ),
                                    "Rejected",
                                    RGBA(
                                        245,
                                        0,
                                        0,
                                        .2
                                    ),
                                    "Approved",
                                    RGBA(
                                        0,
                                        245,
                                        0,
                                        .2
                                    ),
                                    "Canceled",
                                    RGBA(
                                        245,
                                        0,
                                        0,
                                        .2
                                    ),
                                    "Level 1 Approved",
                                    RGBA(
                                        39,
                                        113,
                                        194,
                                        1
                                    ),
                                    "Level 2 Approved",
                                    RGBA(
                                        102,
                                        182,
                                        227,
                                        1
                                    ),
                                    RGBA(
                                        245,
                                        175,
                                        0,
                                        .2
                                    )
                                )
                            FontWeight: =FontWeight.Normal
                            LayoutMinHeight: =70
                            LayoutMinWidth: =280
                            Size: =14
                            Text: |-
                                =If(ThisItem.Draft = 'Draft (Travel Requests)'.Yes,
                                "Draft",Text(ThisItem.'Travel Request Status')
                                )
                            Width: =250
                            Y: =153
                            ZIndex: =3

                        icoRework As icon.Reload:
                            Color: =RGBA(255, 191, 0, 1)
                            Height: =40
                            Icon: =Icon.Reload
                            OnSelect: =Set(locReason, true);Reset(txtDepartmentManagerReason)
                            PaddingLeft: =5
                            PaddingTop: =5
                            Tooltip: ="Rework Reason"
                            Visible: =locRole="CEO" &&  radView.Selected.Value <> "All"
                            Width: =27
                            Y: =81
                            ZIndex: =5

                    Container10 As groupContainer.horizontalAutoLayoutContainer:
                        Height: =225
                        LayoutMinHeight: =60
                        LayoutMinWidth: =100
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =2

                        HtmlText4 As htmlViewer:
                            Color: =RGBA(128, 128, 128, 1)
                            FillPortions: =2
                            Height: =65
                            HtmlText: |-
                                ="<b>Start :</b> "&ThisItem.'Travel Start Date'&"<br><b>End :</b> "&ThisItem.'Travel End Date'
                            LayoutMinHeight: =70
                            LayoutMinWidth: =150
                            Size: =14
                            Width: =100
                            ZIndex: =1

                        HtmlText4_2 As htmlViewer:
                            Color: =RGBA(128, 128, 128, 1)
                            FillPortions: =2
                            Height: =65
                            HtmlText: |-
                                ="<b>Travel Cost:</b> $"&ThisItem.'Travel Cost'&"<br/>
                                <b>Purpose:</b> "&ThisItem.Purpose.Name
                            LayoutMinHeight: =70
                            LayoutMinWidth: =150
                            Size: =14
                            Width: =100
                            ZIndex: =3

                    Container10_1 As groupContainer.horizontalAutoLayoutContainer:
                        Height: =225
                        LayoutMinHeight: =80
                        LayoutMinWidth: =220
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =3

                        htmTravelRequestDetail_2 As htmlViewer:
                            Color: =RGBA(128, 128, 128, 1)
                            FillPortions: =1
                            Height: =100
                            HtmlText: |-
                                ="<b>Approval Reason:</b> "&ThisItem.'Approval Reason'
                            LayoutMinHeight: =70
                            LayoutMinWidth: =130
                            Size: =14
                            Visible: =locRole="CEO"
                            Width: =100
                            Y: =48
                            ZIndex: =4

                        htmTravelRequestDetail_3 As htmlViewer:
                            Color: =RGBA(128, 128, 128, 1)
                            FillPortions: =1
                            Height: =100
                            HtmlText: |-
                                ="<b>Rework Reason:</b> "&ThisItem.'Rejection Reason'
                            LayoutMinHeight: =70
                            LayoutMinWidth: =130
                            Size: =14
                            Visible: =!IsBlank(ThisItem.'Rejection Reason')
                            Width: =100
                            Y: =48
                            ZIndex: =5

                    Container11 As groupContainer.horizontalAutoLayoutContainer:
                        Height: =225
                        LayoutGap: =5
                        LayoutMinHeight: =42
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =1
                        PaddingTop: =1
                        ZIndex: =4

                        btnTravelCompleted As button:
                            Color: =RGBA(153, 153, 153, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Lighter
                            Height: =45
                            HoverFill: =ColorFade(RGBA(153, 153, 153, 1), -20%)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =120
                            OnSelect: |-
                                =Patch(
                                        'Travel Requests',
                                        ThisItem,
                                        {
                                            'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Travel Completed'
                                        }
                                    )
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =16
                            Text: ="☑ Travel Completed"
                            Tooltip: ="Mark the travel request as Completed."
                            Visible: |-
                                =radView.Selected.Value = "Self" && ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Travel Booked' && (CountRows(
                                    Filter(
                                        'Flight Bookings',
                                        'Travel Request ID'.'Travel Request' =ThisItem.'Travel Request'
                                    )
                                ) + CountRows(
                                    Filter(
                                        'Hotel Bookings',
                                        'Travel Request ID'.'Travel Request' = ThisItem.'Travel Request'
                                    )
                                )) = (CountRows(
                                    Filter(
                                        'Flight Bookings',
                                        'Travel Request ID'.'Travel Request' = ThisItem.'Travel Request' && !IsBlank(Invoice)
                                    )
                                ) + CountRows(
                                    Filter(
                                        'Hotel Bookings',
                                        'Travel Request ID'.'Travel Request' = ThisItem.'Travel Request' && !IsBlank(Invoice)
                                    )
                                ))
                            Width: =280
                            ZIndex: =1

                        btnTravelBooked As button:
                            Color: =RGBA(153, 153, 153, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Normal
                            Height: =45
                            HoverFill: =ColorFade(RGBA(153, 153, 153, 1), -20%)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =120
                            OnSelect: |-
                                =Patch(
                                    'Travel Requests',
                                    ThisItem,
                                    {
                                        'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Travel Booked',
                                        Priority: Priority.'Low Priority'
                                    }
                                )
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =16
                            Text: ="☑ Travel Booked"
                            Tooltip: ="Mark travel request as booked."
                            Visible: =(radView.Selected.Value="Self" && ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Approved Pending Booking')
                            Width: =280
                            ZIndex: =2

                        btnApprove As button:
                            Color: =RGBA(153, 153, 153, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Normal
                            Height: =45
                            HoverFill: =ColorFade(RGBA(153, 153, 153, 1), -20%)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =100
                            OnSelect: |-
                                =UpdateContext(
                                    {
                                        /* Adding Hours if approved beyond workhours */
                                        varDeadline: DateAdd(
                                            /*  Adding Days based on whether the deadline lies in the weekend or not, 
                                                Case: Today is Sunday
                                                    Adding 2 days to make deadline Tuesday
                                                Case: Today is Friday
                                                    Adding 4 days to make deading Tuesday
                                                Case: Today is Thursday
                                                    Adding 4 days to make deadline Monday
                                                Case: Today is Saturday
                                                    Adding 3 days to make deading Tuesday
                                             */
                                            DateAdd(
                                                Today(),
                                                2,
                                                Days
                                            ),
                                            /* If today is weekend or working hour has not started, keep the starting hour as 9:00 AM */
                                            If(
                                                Weekday(Today()) in [
                                                    7,
                                                    1
                                                ] || DateDiff(
                                                    Now(),
                                                    Today(),
                                                    Minutes
                                                ) < 540,
                                                540,
                                            /* If working hour is over, keep the starting hour as 9:00 AM of next day */
                                                DateDiff(
                                                    Now(),
                                                    Today(),
                                                    Minutes
                                                ) > 1020,
                                                1980,
                                            /* If time is within working hour, keep deadline time as time as the time it was approved */
                                                DateDiff(
                                                    Now(),
                                                    Today(),
                                                    Minutes
                                                )
                                            ),
                                            Minutes
                                        )
                                    }
                                );
                                Set(
                                    locAutopprovalLimitforCurrentAppointment,
                                    LookUp(
                                        'Request Rules',
                                        'Request Rule ID' = galTravelRequests.Selected.'Applied Request Rule'.'Request Rule ID'
                                    ).'Auto-Approval limit for CEO'
                                );
                                If(
                                    locRole = "Line Manager",
                                    Patch(
                                        'Travel Requests',
                                        ThisItem,
                                        {
                                            'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Level 1 Approved',
                                            'Requested To 1': locL1Manager,
                                            'Requested To 2': locL2tManager,
                                            'Line Manager Approved By': LookUp(
                                                Users,
                                                'Primary Email' = User().Email
                                            ),
                                            Deadline: varDeadline
                                        }
                                    ),
                                    locRole = "Department Manager",
                                    Set(
                                        locReason,
                                        true
                                    );
                                    Reset(txtDepartmentManagerReason),
                                    locRole = "CFO" && Value(galTravelRequests.Selected.'Travel Cost') > locAutopprovalLimitforCurrentAppointment,
                                    Patch(
                                        'Travel Requests',
                                        ThisItem,
                                        {
                                            'Travel Cost Approve': 'Travel Cost Approve (Travel Requests)'.Yes,
                                            'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Level 2 Approved',
                                            'Requested To 1': locL1Manager,
                                            'Requested To 2': Blank(),
                                            'Travel Cost Approved By': LookUp(
                                                Users,
                                                'Primary Email' = User().Email
                                            ),
                                            Deadline: varDeadline,
                                            'Level 2 Approved By': LookUp(
                                                Users,
                                                'Primary Email' = User().Email
                                            )
                                        }
                                    ),
                                    locRole = "CFO" && Value(galTravelRequests.Selected.'Travel Cost') <= locAutopprovalLimitforCurrentAppointment,
                                    Patch(
                                        'Travel Requests',
                                        ThisItem,
                                        {
                                            'Travel Cost Approve': 'Travel Cost Approve (Travel Requests)'.Yes,
                                            'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Approved Pending Booking',
                                            'Requested To 1': Blank(),
                                            'Requested To 2': Blank(),
                                            'Travel Cost Approved By': LookUp(
                                                Users,
                                                'Primary Email' = User().Email
                                            ),
                                            Deadline: varDeadline,
                                            'Level 2 Approved By': LookUp(
                                                Users,
                                                'Primary Email' = User().Email
                                            )
                                        }
                                    ),
                                    locRole = "CEO",
                                    Patch(
                                        'Travel Requests',
                                        ThisItem,
                                        {
                                            'Travel Cost Approve': 'Travel Cost Approve (Travel Requests)'.Yes,
                                            'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Approved Pending Booking',
                                            'Requested To 1': Blank(),
                                            'Requested To 2': Blank(),
                                            'Travel Cost Approved By': LookUp(
                                                Users,
                                                'Primary Email' = User().Email
                                            ),
                                            Deadline: varDeadline
                                        }
                                    )
                                )
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =16
                            Text: ="☑ Approve"
                            Tooltip: ="Approve the travel request."
                            Visible: =locRole <> "Staff" && radView.Selected.Value <> "Self" && ThisItem.'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.Canceled && radView.Selected.Value <> "All"
                            Width: =280
                            ZIndex: =3

                        btnTravelRequestCancel As button:
                            Color: =RGBA(153, 153, 153, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Lighter
                            Height: =45
                            HoverFill: =ColorFade(RGBA(153, 153, 153, 1), -20%)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =100
                            OnSelect: |-
                                =Patch('Travel Requests',ThisItem,{'Travel Request Status':'Travel Request Status (Travel Requests)'.Canceled})
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =16
                            Text: ="☒ Cancel"
                            Tooltip: ="Cancel the travel request"
                            Visible: |-
                                =(ThisItem.'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.'Approved Pending Booking' && ThisItem.'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.Canceled) && radView.Selected.Value <> "All" && If(
                                    radView.Selected.Value = "Requests",
                                    (locRole = "Line Manager" && ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.Pending) || ((locRole = "Department Manager" || locRole = "CFO") && (ThisItem.'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.'Level 1 Approved' || ThisItem.'Travel Request Status' <> 'Travel Request Status (Travel Requests)'.'Rework Reason')) || (locRole = "CEO" && ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Level 2 Approved'),
                                    true
                                )
                            Width: =280
                            ZIndex: =4

                        btnTravelRequestEdit As button:
                            Color: =RGBA(153, 153, 153, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Normal
                            Height: =45
                            HoverFill: =ColorFade(RGBA(153, 153, 153, 1), -20%)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =100
                            OnSelect: |-
                                =Set(locShowRequestForm,true);
                                EditForm(frmTravelRequest);
                                Navigate(Screen1)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =16
                            Text: ="✎ Edit"
                            Tooltip: ="Edit the travel request"
                            Visible: =(radView.Selected.Value="Self" && ThisItem.Draft = 'Draft (Travel Requests)'.Yes &&  radView.Selected.Value <> "All") || (radView.Selected.Value="Self" &&  ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Approved Pending Booking')
                            Width: =280
                            ZIndex: =5

                        btnTravelHistory As button:
                            Color: =RGBA(153, 153, 153, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Lighter
                            Height: =45
                            HoverFill: =ColorFade(RGBA(153, 153, 153, 1), -20%)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =100
                            OnSelect: =Set(locShowTravelAuditHistory,true)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =16
                            Text: ="History"
                            Tooltip: ="View Travel History"
                            Width: =280
                            ZIndex: =6

                        btnTravelRework As button:
                            Color: =RGBA(153, 153, 153, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Normal
                            Height: =45
                            HoverFill: =ColorFade(RGBA(153, 153, 153, 1), -20%)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =100
                            OnSelect: =Set(locReason, true);Reset(txtDepartmentManagerReason)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =16
                            Text: ="⟳ Rework"
                            Visible: =locRole="CEO" &&  radView.Selected.Value <> "All"
                            Width: =280
                            ZIndex: =7

                        Button4_4 As button:
                            Color: =RGBA(153, 153, 153, 1)
                            Fill: =RGBA(255, 255, 255, 1)
                            FillPortions: =1
                            FontWeight: =FontWeight.Lighter
                            Height: =45
                            HoverFill: =ColorFade(RGBA(153, 153, 153, 1), -20%)
                            LayoutMinHeight: =70
                            LayoutMinWidth: =100
                            OnSelect: =Navigate(Screen2)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =16
                            Text: =If(ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Travel Booked',"Upload Invoices","Flight & Hotels")
                            Visible: =(ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.Pending || ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Approved Pending Booking' || ThisItem.'Travel Request Status' = 'Travel Request Status (Travel Requests)'.'Travel Booked') && radView.Selected.Value = "Self"
                            Width: =280
                            ZIndex: =9

    radView As radio:
        Align: =Right
        BorderColor: =RGBA(0, 0, 0, 1)
        Color: =RGBA(128, 128, 128, 1)
        Default: ="Self"
        Height: =61
        Items: =["Self","Requests","All"]
        Layout: =Layout.Horizontal
        RadioBorderColor: =RGBA(0, 0, 0, 1)
        RadioSize: =30
        Size: =14
        Visible: =locRole <> "Staff"
        Width: =317
        X: =300
        Y: =389
        ZIndex: =2

    grpApprovalText As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =7

        rectDeparmentManagerReason As rectangle:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(179, 179, 179, .5)
            Height: =Parent.Height
            Visible: =locReason
            Width: =Parent.Width
            ZIndex: =3

        txtDepartmentManagerReason As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            BorderThickness: =1
            Default: =""
            Height: =184
            HintText: ="Enter the reason"
            Mode: =TextMode.MultiLine
            Size: =18
            Visible: =locReason
            Width: =Parent.Width-2*Self.X
            X: =83
            Y: =467
            ZIndex: =4

        btnDepartmentManagerApprove As button:
            Fill: =RGBA(152, 208, 70, 1)
            Height: =42
            OnSelect: |-
                =UpdateContext(
                    {
                        /* Adding Hours if approved beyond workhours */
                        varDeadline: DateAdd(
                            /*  Adding Days based on whether the deadline lies in the weekend or not, 
                                Case: Today is Sunday
                                    Adding 2 days to make deadline Tuesday
                                Case: Today is Friday
                                    Adding 4 days to make deading Tuesday
                                Case: Today is Thursday
                                    Adding 4 days to make deadline Monday
                                Case: Today is Saturday
                                    Adding 3 days to make deading Tuesday
                             */
                            DateAdd(
                                Today(),
                                2,
                                Days
                            ),
                            /* If today is weekend or working hour has not started, keep the starting hour as 9:00 AM */
                            If(
                                Weekday(Today()) in [
                                    7,
                                    1
                                ] || DateDiff(
                                    Now(),
                                    Today(),
                                    Minutes
                                ) < 540,
                                540,
                            /* If working hour is over, keep the starting hour as 9:00 AM of next day */
                                DateDiff(
                                    Now(),
                                    Today(),
                                    Minutes
                                ) > 1020,
                                1980,
                            /* If time is within working hour, keep deadline time as time as the time it was approved */
                                DateDiff(
                                    Now(),
                                    Today(),
                                    Minutes
                                )
                            ),
                            Minutes
                        )
                    }
                );
                Set(
                    locAutopprovalLimitforCurrentAppointment,
                    LookUp(
                        'Request Rules',
                        'Request Rule ID' = galTravelRequests.Selected.'Applied Request Rule'.'Request Rule ID'
                    ).'Auto-Approval limit for CEO'
                );
                If(
                    locRole = "Department Manager" && Value(galTravelRequests.Selected.'Travel Cost') > locAutopprovalLimitforCurrentAppointment,
                    Patch(
                        'Travel Requests',
                        galTravelRequests.Selected,
                        {
                            'Approval Reason': txtDepartmentManagerReason.Text,
                            'Department Manager Approve': 'Department Manager Approve (Travel Requests)'.Yes,
                            'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Level 2 Approved',
                            'Requested To 1': locL2tManager,
                            'Requested To 2': Blank(),
                            'Original Travel Cost': galTravelRequests.Selected.'Travel Cost',
                            Deadline: varDeadline,
                            'Is Automatically Approved': 'Is Automatically Approved (Travel Requests)'.Yes,
                            'Department Managed Approved By': LookUp(
                                Users,
                                'Primary Email' = User().Email
                            ),
                            'Level 2 Approved By': LookUp(
                                Users,
                                'Primary Email' = User().Email
                            )
                        }
                    ),
                    locRole = "Department Manager" && Value(galTravelRequests.Selected.'Travel Cost') <= locAutopprovalLimitforCurrentAppointment,
                    Patch(
                        'Travel Requests',
                        galTravelRequests.Selected,
                        {
                            'Approval Reason': txtDepartmentManagerReason.Text,
                            'Department Manager Approve': 'Department Manager Approve (Travel Requests)'.Yes,
                            'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Approved Pending Booking',
                            'Requested To 1': Blank(),
                            'Requested To 2': Blank(),
                            'Original Travel Cost': galTravelRequests.Selected.'Travel Cost',
                            Deadline: varDeadline,
                            'Is Automatically Approved': 'Is Automatically Approved (Travel Requests)'.Yes,
                            'Department Managed Approved By': LookUp(
                                Users,
                                'Primary Email' = User().Email
                            ),
                            'Level 2 Approved By': LookUp(
                                Users,
                                'Primary Email' = User().Email
                            )
                        }
                    ),
                    locRole = "CEO",
                    Patch(
                        'Travel Requests',
                        galTravelRequests.Selected,
                        {
                            'Rejection Reason': txtDepartmentManagerReason.Text,
                            'Travel Request Status': 'Travel Request Status (Travel Requests)'.'Rework Reason',
                            Deadline: varDeadline,
                            'Requested To 1': galTravelRequests.Selected.'Department Managed Approved By'
                        }
                    )
                );
                Set(
                    locReason,
                    false
                )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: |-
                =If(
                    locRole = "CEO",
                    "Reword",
                    "Approve"
                )
            Visible: =locReason
            Width: =118
            X: =txtDepartmentManagerReason.X+txtDepartmentManagerReason.Width-Self.Width
            Y: =662
            ZIndex: =5

        Icon1 As icon.Cancel:
            Color: =RGBA(184, 0, 0, 1)
            Height: =42
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(
                    locReason,
                    false
                )
            Visible: =locReason
            Width: =37
            X: =txtDepartmentManagerReason.X+txtDepartmentManagerReason.Width-Self.Width
            Y: =420
            ZIndex: =6

    Label1 As label:
        Align: =Center
        Color: =RGBA(128, 128, 128, 1)
        FontWeight: =Lighter
        Height: =50
        Size: =21
        Text: ="No travel request found."
        Visible: =CountRows(galTravelRequests.AllItems)=0
        Width: =Parent.Width
        Y: =Parent.Height/2
        ZIndex: =10

    grpTravelAuditHistory As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =10

        Rectangle4 As rectangle:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(0, 0, 0, 0.5)
            Height: =Parent.Height
            Visible: =locShowTravelAuditHistory
            Width: =Parent.Width
            ZIndex: =7

        datTravelAuditHistory As dataTable.datatable:
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =1
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(255, 255, 255, 1)
            HeadingSize: =14
            Height: =337
            Items: =Filter('Travel Request Audits','Travel Request'.'Travel Request'=galTravelRequests.Selected.'Travel Request')
            SelectedFill: =RGBA(255, 255, 255, .2)
            Size: =14
            Visible: =locShowTravelAuditHistory
            Width: =If(Parent.Width>800,800,Parent.Width-80)
            X: =(Parent.Width - Self.Width)/2
            Y: =194
            ZIndex: =8

            "'Travel Request Status_Column1' As dataTableColumn.textualColumn":
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Travel Request Status"
                FieldName: ="sb_travelrequeststatus"
                FieldVariantName: ="textualColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =1
                Text: =ThisItem.'Travel Request Status'
                Width: =100
                X: =0
                Y: =0
                ZIndex: =14

            "'Modified On_Column1' As dataTableColumn.dateTimeColumn":
                AutoWidth: =false
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Date"
                FieldName: ="modifiedon"
                FieldVariantName: ="dateTimeColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =4
                Text: =Text(ThisItem.'Modified On',DateTimeFormat.ShortDate)
                Width: =110
                X: =0
                Y: =0
                ZIndex: =15

            "'Update By_Column1' As dataTableColumn.complexTypeColumn":
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Update By"
                FieldName: ="sb_UpdateBy"
                FieldVariantName: ="complexTypeColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =3
                Text: =ThisItem.'Update By'.'Full Name'
                Width: =100
                X: =0
                Y: =0
                ZIndex: =16

        Icon4 As icon.Cancel:
            Color: =RGBA(255, 0, 0, 1)
            Height: =40
            Icon: =Icon.Cancel
            OnSelect: =Set(locShowTravelAuditHistory,false)
            Visible: =locShowTravelAuditHistory
            Width: =33
            X: =datTravelAuditHistory.X+datTravelAuditHistory.Width-Self.Width
            Y: =153
            ZIndex: =9

    Label2 As label:
        FontWeight: =Lighter
        Height: =49
        Size: =15
        Text: ="V1.8"
        Width: =51
        X: =Image2.X-Self.Width
        Y: =25
        ZIndex: =11

    Rectangle5 As rectangle:
        Fill: =RGBA(0, 0, 0, 0.5)
        Height: =Parent.Height
        Visible: =locShowAttachmentDialog
        Width: =Parent.Width
        ZIndex: =12

    Form1 As form:
        BorderColor: =RGBA(230, 230, 230, 1)
        BorderThickness: =2
        DataSource: ='Travel Requests'
        Fill: =RGBA(255, 255, 255, 1)
        Height: =765
        Item: =galTravelRequests.Selected
        OnSuccess: =Set(locShowAttachmentDialog,false)
        Visible: =locShowAttachmentDialog
        Width: =589
        X: =(Parent.Width-Self.Width)/2
        Y: =60
        ZIndex: =13

        DataCard3 As typedDataCard.blankCard:
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =100
            Width: =587
            X: =0
            Y: =0
            ZIndex: =1

            Label3 As label:
                Height: =70
                Size: =21
                Text: ="Upload Invoices"
                Width: =560
                X: =40
                Y: =15
                ZIndex: =1

            Rectangle6 As rectangle:
                Fill: =RGBA(230, 230, 230, 1)
                Height: =2
                Width: =587
                Y: =95
                ZIndex: =2

        Attachments_DataCard1 As typedDataCard.attachmentsEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="{Attachments}"
            Default: =ThisItem.Attachments
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Travel Requests'],DataSourceInfo.DisplayName,"{Attachments}")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue27.Attachments
            Width: =587
            X: =0
            Y: =1
            ZIndex: =1

            DataCardKey35 As label:
                AutoHeight: =true
                Height: =48
                Size: =16
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue27 As attachments:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                DisplayMode: =Parent.DisplayMode
                Height: =520
                IsInDataCard: =true
                Items: =Parent.Default
                PaddingBottom: =5
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PaddingRight: =5
                PaddingTop: =5
                Size: =21
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey35.Y + DataCardKey35.Height + 5
                ZIndex: =2

            ErrorMessage33 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Size: =24
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue27.Y + DataCardValue27.Height
                ZIndex: =3

            StarVisible33 As label:
                Align: =Align.Center
                Height: =DataCardKey35.Height
                Size: =21
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey35.Y
                ZIndex: =4

        DataCard4 As typedDataCard.blankCard:
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =68
            Width: =588
            X: =0
            Y: =2
            ZIndex: =1

            Button5 As button:
                Color: =RGBA(128, 128, 128, 1)
                Fill: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Normal
                Height: =49
                OnSelect: =SubmitForm(Form1)
                Size: =16
                Text: ="Save"
                Width: =118
                X: =35
                Y: =5
                ZIndex: =1

            Button5_1 As button:
                Color: =RGBA(128, 128, 128, 1)
                Fill: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Normal
                Height: =49
                OnSelect: =Set(locShowAttachmentDialog,false)
                Size: =16
                Text: ="Cancel"
                Width: =118
                X: =161
                Y: =5
                ZIndex: =2

    Container14 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =Parent.Height
        PaddingBottom: =20
        PaddingLeft: =20
        PaddingRight: =20
        PaddingTop: =20
        Visible: =showPowerBIDashboard
        Width: =Parent.Width
        ZIndex: =15

        PowerBI1 As powerbi:
            BorderThickness: =0
            DashboardId: =""
            Height: =Parent.Height
            OnSelect: |-
                =UpdateContext({showPowerBIDashboard:false})
            TileUrl: |-
                ="https://app.powerbi.com/reportEmbed?reportId=742cc471-41d5-4e43-b0ac-0bdb8b084ddb&autoAuth=true&ctid=ca4eb3f5-6926-47a6-b50d-054a4d36dfdd"
            Visible: =showPowerBIDashboard
            Width: =Parent.Width-2*Parent.PaddingLeft
            WorkspaceId: ="__my-workspace"
            X: =Parent.PaddingLeft
            Y: =Parent.PaddingLeft
            ZIndex: =1

        Icon3 As icon.CancelBadge:
            Height: =45
            Icon: =Icon.CancelBadge
            OnSelect: |-
                =UpdateContext({showPowerBIDashboard:false})
            Width: =45
            X: =5
            Y: =5
            ZIndex: =2

    Container21 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(0, 0, 0, 0.35)
        Height: =Parent.Height
        Visible: =varShowApprovedExistsDialog
        Width: =Parent.Width
        ZIndex: =16

        Label7 As label:
            Align: =Align.Center
            Height: =202
            Size: =15
            Text: ="You have travel requests approved by the administration. Please mark it as 'Travel Booked' if there are no changes to original proposed flights/hotels. If they are not be available now, you require to find alternative flights/hotels and update Flights & Hotel. This may cause the Travel Dates or the Travel Cost (or both) to change and require for re-approval if the cost change is more than 10%"
            Width: =560
            X: =(Parent.Width-Self.Width)/2
            Y: =324
            ZIndex: =2

        Group1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =4

            Rectangle3 As rectangle:
                DisplayMode: =DisplayMode.Disabled
                Fill: =RGBA(255, 255, 255, 1)
                Height: =325
                OnSelect: |-
                    =UpdateContext({varShowApprovedExistsDialog:false})
                Width: =582
                X: =(Parent.Width-Self.Width)/2
                Y: =324
                ZIndex: =1

            Button2 As button:
                Color: =RGBA(128, 128, 128, 1)
                Fill: =RGBA(255, 255, 255, 1)
                Height: =70
                OnSelect: |-
                    =UpdateContext({varShowApprovedExistsDialog:false})
                Size: =24
                Text: ="Ok"
                Width: =178
                X: =(Parent.Width-Self.Width)/2
                Y: =540
                ZIndex: =3

    Icon8 As icon.Reload:
        Height: =52
        Icon: =Icon.Reload
        OnSelect: =Refresh('Travel Requests')
        Width: =30
        X: =Label2.X-Self.Width-10
        Y: =23
        ZIndex: =17

    Label11 As label:
        Height: =70
        Size: =21
        Text: |-
            =radView.Selected.Value = "Self" && (CountRows(
                Filter(
                    'Flight Bookings',
                    'Travel Request ID'.'Travel Request' = galTravelRequests.Selected.'Travel Request'
                )
            ) + CountRows(
                Filter(
                    'Hotel Bookings',
                    'Travel Request ID'.'Travel Request' = galTravelRequests.Selected.'Travel Request'
                )
            )) = (CountRows(
                Filter(
                    'Flight Bookings',
                    'Travel Request ID'.'Travel Request' = galTravelRequests.Selected.'Travel Request' && !IsBlank(Invoice)
                )
            ) + CountRows(
                Filter(
                    'Hotel Bookings',
                    'Travel Request ID'.'Travel Request' = galTravelRequests.Selected.'Travel Request' && !IsBlank(Invoice)
                )
            ))
        Width: =560
        X: =80
        Y: =80
        ZIndex: =18

