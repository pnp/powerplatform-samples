var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var c={};c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var b={};/*!*****************************************!*\
  !*** ./SpinButton/index.ts + 4 modules ***!
  \*****************************************/c.r(b),c.d(b,{SpinButton:()=>N});const o=React,p=FluentUIReactv8290;var M=Object.defineProperty,V=Object.defineProperties,j=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,w=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,v=(e,t)=>{for(var n in t||(t={}))D.call(t,n)&&w(e,n,t[n]);if(S)for(var n of S(t))T.call(t,n)&&w(e,n,t[n]);return e},R=(e,t)=>V(e,j(t));const P=o.memo(e=>{const{themeJSON:t,onChanged:n,min:d,max:h,step:m,suffix:u,error:f,setFocus:l}=e,y={iconName:e.iconName},[O,_]=o.useState(u),s=o.useRef(null),[C,i]=o.useState(),F=o.useCallback((a,r)=>{r&&n(r)},[n]),g=a=>{const r=/^(\d+(\.\d+)?).*/;if(r.test(a)){const I=Number(a.replace(r,"$1"));return isNaN(I)?void 0:I}},L=a=>{let r=g(a);if(r!==void 0)return r=Math.min(r,h),r=Math.max(r,d),String(r)+u},W=a=>{const r=g(a);if(r!==void 0)return String(Math.min(r+m,h))+u},U=a=>{const r=g(a);if(r!==void 0)return String(Math.max(r-m,d))+u},J=o.useMemo(()=>{try{return t?(0,p.createTheme)(JSON.parse(t)):void 0}catch(a){console.error("Cannot parse theme",a)}},[t]);o.useEffect(()=>{_(u)},[u]),o.useEffect(()=>{if(i(f===!0?{spinButtonWrapper:{"::after":{borderColor:"#BA3D22 !important"}}}:{spinButtonWrapper:{"::after":{borderColor:"rgb(96, 94, 92) !important"}}}),l&&l!==""&&s){const a=s.current.getElementsByClassName("ms-spinButton-input");a&&a.length>0&&a[0].focus()}},[l,s,f,i]);const x=(0,p.mergeStyles)({width:e.width}),H=v({},R(v({},e),{iconProps:y,onChange:F,onValidate:L,onIncrement:W,onDecrement:U,key:O,ref:s,styles:C,className:x}));return o.createElement(p.ThemeProvider,{theme:J,className:"PowerCATSpinButton"},o.createElement(p.SpinButton,v({},H)))});P.displayName="SpinButtonComponent";var B=(e=>(e.SetFocus="SetFocus",e))(B||{}),A=(e=>(e.InputEvent="InputEvent",e))(A||{});const E=class{constructor(){this.setFocus="",this.onChange=e=>{this.spinButtonValue=e!=null?e:null,this.delayOutput?this.debouncedOutputChanged&&this.debouncedOutputChanged():this.notifyOutputChanged&&this.notifyOutputChanged()},this.onChange=this.onChange.bind(this),this.asyncFluent=new p.Async}init(e,t){this.notifyOutputChanged=t,this.context=e,this.context.mode.trackContainerResize(!0),this.notifyOutputChanged&&(this.debouncedOutputChanged=this.asyncFluent.debounce(this.notifyOutputChanged,E.DELAY_TIMEOUT))}updateView(e){var t,n,d,h,m,u,f,l;const y=parseInt(e.mode.allocatedWidth),O=parseInt(e.mode.allocatedHeight),_=(t=e.parameters.Step.raw)!=null?t:1;let s=(n=e.parameters.Suffix.raw)!=null?n:"";s=s.length>0?" ".concat(s):"";const C=((d=e.parameters.DefaultValue.raw)!=null?d:"0").concat(s);this.delayOutput=e.parameters.DelayOutput.raw;const i=this.context.parameters.InputEvent.raw;i&&this.setFocus!==i&&i.startsWith(B.SetFocus)&&(this.setFocus=i);const g={label:(h=e.parameters.Label.raw)!=null?h:"",iconName:(m=e.parameters.IconName.raw)!=null?m:"",defaultValue:C,min:(u=e.parameters.Min.raw)!=null?u:0,max:(f=e.parameters.Max.raw)!=null?f:100,step:_,incrementButtonAriaLabel:"Increase value by "+_+s,decrementButtonAriaLabel:"Decrease value by "+_+s,themeJSON:(l=e.parameters.Theme.raw)!=null?l:"",disabled:e.mode.isControlDisabled,width:y,height:O,suffix:s,onChanged:this.onChange,error:e.parameters.Error.raw,setFocus:this.setFocus};return o.createElement(P,g)}getOutputs(){return{Value:this.spinButtonValue}}destroy(){this.notifyOutputChanged=null,this.asyncFluent.dispose()}};let N=E;N.DELAY_TIMEOUT=500,pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=b})();

if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.SpinButton', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.SpinButton);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.SpinButton = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.SpinButton;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}